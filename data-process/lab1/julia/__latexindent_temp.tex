\documentclass[a4paper]{article}

\input{style/template.tex}


\lstset{frame=, basicstyle={\footnotesize\ttfamily}}



\graphicspath{ {images/} }
\usepackage{ctex}
\usepackage{fontspec}
\setmonofont[
  Contextuals={Alternate}
]{Fira Code}
%-----------------------------------------BEGIN DOC----------------------------------------

\begin{document}
\renewcommand{\contentsname}{目\ 录}
\renewcommand{\appendixname}{附录}
\renewcommand{\appendixpagename}{附录}
\renewcommand{\refname}{参考文献} 
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\renewcommand{\today}{\number\year 年 \number\month 月 \number\day 日}

\title{{\Huge 数据挖掘实验实验报告{\large\linebreak\\}}{\Large 实验一: 数据预处理\linebreak\linebreak}}
%please write your name, Student #, and Class # in Authors, student ID, and class # respectively
\author{\\姓\ 名:柴\ 博\ 文\\ 
学\ 号: 04194012\\
班\ 号: 大数据1901\\\\
数据挖掘与机器学习\\
(秋季, 2021)\\\\
西安邮电大学\\
计算机学院\\
数据科学与大数据专业}
\date{\today}
\maketitle
\newpage

%-----------------------------------------ABSTRACT-------------------------------------
\begin{center}
{\Large\bf{摘\ 要\\}}
\end{center}
本次实验使用Julia语言进行实现.

如果需要运行本项目代码,请安装python以及matplot

随后打开终端,运行Julia

安装XLSX,CSV,DataFrames,Plots,Dates,Statistics

实验报告采用LaTeX, 在overleaf上进行编写.

通过DataFrames, CSV, XLSX读取数据, PyPlots, Plots, StatsPlot绘制图案.

本次实验代码均可以在\href{https://github.com/lovebaihezi/lab/tree/main/data-process/lab1/julia}{github仓库}下找到.

\newpage
%-----------------------------------------CONTENT-------------------------------------
\begin{center}
\tableofcontents\label{c}
\end{center}
\newpage

%------------------------------------------TEXT--------------------------------------------

%----------------------------------------OVERVIEW-----------------------------------------

\section{概述} \label{overview}%------------------------------

1、掌握数据探索统计特征计算、数据可视化等基本方法

2、掌握数据集缺失值、含噪数据的平滑处理、数据变换、数据集成等预处理方法。

3、掌握PCA主成分分析等降维方法

\begin{itemize}
	\item{\textbf{数据可视化}对某县广电宽带用户的5000条数据（或者自己感兴趣的其他领域的数据）进行探索，通过统计特征可视化进行数据分析，探索发现你感兴趣的知识。}
    \item{\textbf{数据处理}对北京西安的年薪数据（或者自己感兴趣的其他领域的数据）计算均值，方差等统计特征，绘制据箱体图和小提琴图等图，分析北京西安年薪的差异。}
    \item{\textbf{数据清洗}用'movie\_metadata.csv'数据集（或者自己感兴趣的其他领域的数据）进行案例分析，这个数据集包含了包括演员、导演、预算、总输入，以及IMDB评分和上映时间等信息，进行处理缺失数据，可以是添加默认值，删除不完整的行，异常值处理，重复数据处理，规范化数据类型等等。
    }
    \item{\textbf{数据集成}合并两个给定数据集：ReaderRentRecode.csv和ReaderInformation.csv（或者自己感兴趣的其他领域的数据），其中两个数据集的共同点是具有相同的num属性，最终生成一个综合的数据集。
    }
    \item{\textbf{PCA}使用鸢尾花数据集（或者自己感兴趣的其他领域的数据），这个数据集有150个样本，其中每个样本有五个变量，其中四个为特征变量,分别为萼片长度（Sepal length）, 萼片宽度（Sepalwidth）,花瓣长度（Petallength）,花瓣宽度（Petalwidth），还有一个变量是其所属的品种的类别变量（Species），这个鸢尾花内别共有3种类别分别是山鸢尾（Iris-setosa）、变色鸢尾（Iris-versicolor）和维吉尼亚鸢尾（Iris-virginica），首先对4维的原始数据集实现可视化，可视化一组数据来观察数据分布，然后对数据集进行标准化（归一化），接着利用PCA主成分分析将数据降到二维。}
\end{itemize}

%------------------------------------Lab Process--------------------------------------

\newpage
%------------------------------
\section{数据可视化}\label{sub:ptx}
\subsection{实验过程} \label{sub:ptxproc}

首先使用Excel讲旧版Excel格式的xls文件转换为CSV文件\href{"https://github.com/lovebaihezi/lab/blob/main/data-process/lab1/julia/file/xian_guangdian.csv"}{github}

随后使用CSV读取文件内容, 并通过DataFrame解析格式以及类型图\ref{fig:csvinfo}. 

\begin{figure}[ht]
 \centering
 \includegraphics[width=5cm]{images/广电信息CSV展示.png}
 \caption{广电信息CSV}
 \label{fig:csvinfo}
\end{figure}

\begin{lstlisting}[language=julia]
quality =
    "lab1/julia/file/xian_guangdian.csv" |>
    CSV.File |>
    DataFrame |>
    data ->
        begin
            combine(nrow, groupby(select(data, :客户等级), :客户等级)) |>
            data -> rename(data, :nrow => "用户数量") |> println
            combine(nrow, groupby(select(data, [:客户等级, :网络类型]), 
                                                [:客户等级, :网络类型]))
        end |>
        data ->
            rename(data, 
                :nrow => :quantity, 
                    :网络类型 => :net_kind, 
                        :客户等级 => :user_level)
data = combine(groupby(quality, :net_kind), [:user_level, :quantity])
dict = Dict(
    "5星ABD客户" => "star_5ABD",
    "离线" => "out_link",
    "3星AB客户" => "star_3AB",
    "1星D客户" => "star_1D",
    "1星A客户" => "star_1A",
    "VIP商业个人客户" => "vip",
    "3星AD客户" => "start_3AD",
)
1:(data|>nrow) .|>
i -> begin
    data[i, :net_kind] =
        Dict(
            "农网用户" => "village", 
            "城网用户" => "city",
            " " => "unknown"
        )[data[
            i,
            :net_kind,
        ]]
    data[i, :user_level] = dict[data[i, :user_level]]
end
gp = groupby(data, :net_kind)
gp |>
keys .|>
kind -> @df combine(gp[kind], [:user_level, :quantity]) plot(
    :user_level,
    :quantity,
    label = "$kind",
) |> fig -> savefig(fig, "lab1/julia/images/first_$kind")
\end{lstlisting}

随后将数据根据客户等级进行分组,总共有7组,见图\ref{fig:customgroup}. 
\begin{figure}[ht]
 \centering
 \includegraphics[width=5cm]{images/广电客户.png}
 \caption{分组结果图}
 \label{fig:customgroup}
\end{figure}

再将每组一网络类型进行分组, 图\ref{fig:netgroup}. 

\begin{figure}[ht]
 \centering
 \includegraphics[width=5cm]{images/网络分组.png}
 \caption{分组结果图}
 \label{fig:netgroup}
\end{figure}

然后将每组画到折线图之上,
\begin{figure}
    \centering
    \includegraphics[width=3cm]{images/city.png}
    \label{fig:city}
    \includegraphics[width=3cm]{images/village.png}
    \label{fig:village}
    \includegraphics[width=3cm]{images/unknown.png}
    \caption{城市居民, 农村, 未登记}
    \label{fig:unknown}
\end{figure}

\subsection{实验结果和分析}\label{sub:ptxeva}

通过该次结果可以看出,在办理了广电业务的客户之中,5星ABD客户数目远远多余其他客户,而且明显城区用户多余农村用户

但是低级用户和高级用户的数量几乎差不多,而且最关键的是两个图的趋势是相似的,说明农村和城市对于网络的需求是很一致的

\newpage

% --------------------------------Evaluation----------------------------------------
\section{数据处理}\label{sub:process}
\subsection{实验过程} \label{sub:process-lab}

使用XLSX将文件内容读入,并使用DataFrame对数据进行类型判断并转换位DataFrame类型
随后使用统计模块中的统计方法求数据的均值,方差,标准差,协方差矩阵

\begin{lstlisting}[language=julia]
\end{lstlisting}


% -----------------------------------Appendix----------------------------------------
\appendix
\section{代码}\label{sub:app.code}
请在附录\ref{sub:app.code}中添加代码。请使用如下C或者C++的语法高亮描述方法。
\begin{lstlisting}[language=julia]

using XLSX;
using CSV;
using DataFrames;
using Plots;
using Dates;
using StatsPlots;
using PyPlot;

file_path = "file/xian_guangdian.csv";
data = CSV.File(file_path) |> DataFrame

\end{lstlisting}
\end{document}

